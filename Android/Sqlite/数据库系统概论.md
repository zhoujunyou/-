第三章：关系数据库标准语言SQL

* Where 字句与Having短语区别在于对象不同，where子句作用于基本表或视图，从中选择满足条件的元组。having短语用语组，从中选择满足条件的组
* where子句中是不能用聚集函数作为条件表达式的。
* 左外连接列出左边关系中所有的元组，右外连接列出右边关系中所有的元组
* SQLite 只支持 左外连接（LEFT OUTER JOIN），在 SQLite 中，除了重命名表和在已有的表中添加列，ALTER TABLE 命令不支持其他操作。

* 目前商用关系数据集管理系统对嵌套查询的优化做的还不够完善，所以在实际应用中，能够用连接运算表达式的查询尽可能采用连接运算。
* 求解相关子查询不能像求解不相关子查询那样一次将子查询求解出来，然后求解父查询。内层查询由于与外层查询有关，因此必须反复求值。

第五章:数据库完整性

* 实体完整性：在create table中用primary key定义。
  * 检查主码值是否唯一，如果不唯一则拒绝插入或修改。
  * 检查主码的各个属性是否为空，只要一个为空就拒绝插入或修改。
* 参照完整性： 在create table中用foreign key短语定义哪些列为外码用references短语指明这些外码参照哪些表的主码。当不一致时可以采用下列策略处理
  * 拒绝执行
  * 级联操作
  * 设置为空值
* 用户定义的完整性：NOT NULL ，UNIQUE,CHECK短语。元组约束条件。
* 完整性约束命名子句： CONSTRAINT子句
* 域中的完整性限制:CREATE DOMAIN 
* 断言：CREATE ASSERTION<断言句><CHECK 子句>
* 触发器(trigger):当特定的系统事件(如对一个表的增 删 改 查，事务结束)发生时，对规则的条件进行检查，如果条件成立则执行规则中的动作

第六章:关系数据理论

* 一个好的模式应当不会发生插入异常，删除异常，更新异常，数据冗余尽可能少。

  [如何解释关系数据库的第一第二第三范式？](<https://www.zhihu.com/question/24696366>)

* 第一范式：符合1NF的关系中的每个属性都不可再分，1NF是所有关系型数据库的最基本要求。

* 第二范式： **是否存在非主属性对于码的部分函数依赖**？不存在则符合。

  （消除非主属性对码的部分依赖）

* 第三范式：**3NF在2NF的基础之上，消除了非主属性对于码的传递函数依赖**

* BCNF: 消除主属性对码的部分和传递函数依赖

* 第四范式：消除非平凡且非函数依赖的多值依赖。

第八章：数据库编程

* 动态SQL :
  1. 使用SQL语句主变量
  2. 动态参数：使用参数符合（?）表示该位置的数据在运行时设定。准备SQL语句（PREPARE）PREPARE将分析含主变量的SQL语句内容，建立语句中包含的动态参数的内部描述符
  3. 执行准备好的语句（EXECUTE）：EXECUTE将SQL语句中分析出的动态参数和主变量或数据常量绑定，作为语句的输入或输出变量。
* ODBC工作原理概述：
  * 用户应用程序
    1. 请求连接数据库
    2. 向数据源发送SQL语句
    3. 为SQL语句执行结果分配存储空间，定义所读取数据格式
    4. 获取数据库操作的结果或处理错误
    5. 进行数据处理并向用户提交处理结果
    6. 请求事物的提交和回滚操作
    7. 断开与数据源的连接
  * ODBC工作流程
    1. 配置数据源
    2. 初始化环境
    3. 建立连接
    4. 分配语句句柄
    5. 执行SQL语句
    6. 结果集处理
    7. 中止处理

第十章：数据库恢复技术

* 事务的基本概念：事务时用户定义的一个数据库操作序列，要么全做要么全不做，是一个不可分割的工作单位。COMMIT表示提交。ROLLBACK表示回滚

* 事务的ACID特性：原子性，一致性。隔离，持续。

  





---

练习

```sql
create TABLE S (SNO CHAR(11) PRIMARY KEY,SNAME CHAR(10),STATUS SMALLINT,CITY CHAR(10));
CREATE TABLE P (PNO CHAR(10) PRIMARY KEY,PNAME CHAR(10),COLOR CHAR(10),WEIGHT SMALLINT)
CREATE TABLE J (JNO CHAR(10) PRIMARY KEY,JANAME CHAR(10),CITY CHAR(10));
DROP TABLE J;
CREATE TABLE SPJ (SNO CHAR(11) 
,PNO CHAR(10) 
,JNO CHAR(10) 
,QTY SMALLINT
,PRIMARY KEY (SNO,PNO,JNO)
,FOREIGN KEY (SNO) REFERENCES S(SNO)
,FOREIGN KEY (PNO) REFERENCES P(PNO)
,FOREIGN KEY (JNO) REFERENCES J(JNO)
)

INSERT INTO  S VALUES('S1','精益',20,'天津')
INSERT INTO  S VALUES('S2','盛锡',10,'北京')
INSERT INTO  S VALUES('S3','东方红',30,'北京');
INSERT INTO  S VALUES('S4','丰泰盛',20,'天津');
INSERT INTO  S VALUES('S5','为民',30,'上海');

INSERT  INTO  P VALUES('P1','螺母','红',12);
INSERT  INTO  P VALUES('P2','螺栓','绿',17);
INSERT  INTO  P VALUES('P3','螺丝刀','蓝',14);
INSERT  INTO  P VALUES('P4','螺丝刀','红',14);
INSERT  INTO  P VALUES('P5','凸轮','蓝',40);
INSERT  INTO  P VALUES('P6','齿轮','红',30);

INSERT  INTO  J VALUES('J1','三建','北京');
INSERT  INTO  J VALUES('J2','一汽','长春');
INSERT  INTO  J VALUES('J3','弹簧厂','天津');
INSERT  INTO  J VALUES('J4','造船厂','天津');
INSERT  INTO  J VALUES('J5','机车厂','唐山');
INSERT  INTO  J VALUES('J6','无线电厂','常州');
INSERT  INTO  J VALUES('J7','半导体厂','南京');

INSERT INTO SPJ VALUES('S1','P1','J1',200);
INSERT INTO SPJ VALUES('S1','P1','J3',100);
INSERT INTO SPJ VALUES('S1','P1','J4',700);
INSERT INTO SPJ VALUES('S1','P2','J2',100);

INSERT INTO SPJ VALUES('S2','P3','J1',400);
INSERT INTO SPJ VALUES('S2','P3','J2',200);
INSERT INTO SPJ VALUES('S2','P3','J4',500);
INSERT INTO SPJ VALUES('S2','P3','J5',400);
INSERT INTO SPJ VALUES('S2','P5','J1',400);
INSERT INTO SPJ VALUES('S2','P5','J2',100);
```

